## 系统状态与管理

### 一、进程状态

Linux 是⼀个多任务操作系统，同⼀时刻允许多个任务同时⼯作，运⾏中的每⼀个任务就是⼀个进程。查看进程信息常⽤的命令有 ps 和 top。

### ps命令

ps即是process status，用来查看进程状态，显示的是敲下命令后一瞬间的进程状态，ps如果不带参数显示的信息很少

ps：显示格式

 PID 			TTY 			TIME 			CMD
25838 		pts/0 		00:00:00 		bash
27269 		pts/0 		00:00:00 		ps

ps三种不同类型的命令行参数：

- Unix风格：参数前面加`-`如	ps -ef
- BSD风格：前面不加`-`,如    ps aux
- GNU风格：前面加`--`,如   ps --pid 123

**ps -ef**

![1567165516344](C:\Users\lwq\Desktop\Linux\linux操作3\img\1567165516344.png)

- 参数详解：
  - -e:参数指定显示所有运行在系统上的进程
  - -f:扩展了输出
- 结果详解：
  - UID:启动这些进程的用户
  - PID:进程ID
  - PPID:父进程的进程号（如果是由另一个进程启动的）
  - C:进程生命周期中的CPU利用率
  - STIME：进程启动时的系统时间
  - TTY:进程启动时的终端设备
  - TIME：程序累计占用CPU的时间
  - CMD：进程运行的命令

**ps aux**

![1567165910592](C:\Users\lwq\Desktop\Linux\linux操作3\img\1567165910592.png)

- 参数详解：
  - a :显示跟任意终端关联的所有进程
  - u :采用基于用户的格式显示（人性化）
  - x :显示所有的进程，甚至包括未分配任何终端的进程
- 结果详解：
  - USER: 执行这个进程的用户
  - PID: 进程的ID
  - %CPU:当前进程的CPU占用
  - &MEM:当前进程的内存占用
  - VSZ:进程占用的虚拟内存大小，以kb为单位，
  - RSS：进程占用的物理内存大小
  - TTY:进程启动时的终端设备
  - STAT:进程状态
    - S 是整体的状态  s对前面状态的说明 < :高优先级  N:低优先级   L：该进程有页面锁定			在内存中 	s:该进程是控制进程，管理别的进程	l:该进程是多线程			的		+:表示进程运行在前台
  
  - start: 进程启动时刻
  - TIME : 程序累计占⽤ CPU 的时间
  - COMMAND : 启动进程的命令
  - 关于 STAT
    - 代表当前进程状态的双字符状态码。
    - 第⼀个字符表明进程状态:
      - O : 代表正在运⾏
      - S : 代表在休眠
      - R : 代表可运⾏，正等待 CPU
      - Z : 代表僵化，进程已结束但⽗进程已不存在
      - T : 代表停⽌
    - 第⼆个参数进⼀步说明进程的状态细节:
      - < : 该进程运⾏在⾼优先级上。
      - N : 该进程运⾏在低优先级上。
      - L : 该进程有⻚⾯锁定在内存中。
      - s : 该进程是控制进程。
      - l : 该进程是多线程的。
      - +: 该进程运⾏在前台。

### top 命令
ps 命令只能查看⼀瞬间的进程状态，如果想要持续查看某些进程的状态可以使⽤ top

![](C:\Users\lwq\Desktop\Linux\linux操作3\img\1567166814780.png)

头信息逐⾏详解:

	1. 系统运⾏的整体状态: 开机时⻓，登陆⽤户数，系统负载
			系统负载: load average: 0.00, 0.02, 0.05
			分别代表: ⼀分钟负载，五分钟负载，⼗五分钟负载
			负载值越⾼代表服务器压⼒越⼤
			负载值不要超过 CPU 的核⼼数。如果超过核⼼数意味着有很多进程在			等待使⽤ CPU
			与 uptime 命令的结果⼀样 (查看系统状态)

2. 任务情况: 任务总数，运⾏中的数量，休眠数量，停⽌数量，僵⼫进程数量

3. CPU 使⽤情况

   us: (user) ⽤户态占⽤
   sy: (system) 内核态占⽤
   id: (idle) 空闲的 CPU

4.  内存占⽤情况: 内存总量, 空闲内存, 使⽤的内存, 缓冲区占⽤的内存

5.  交换分区的占⽤
           交换分区是⼀种将内存数据保存到硬盘的技术，⼀般在内存不⾜的时      候使⽤

   ​		linux的虚拟内存就是声明一下，并不会分配给他硬盘，，真正使用也会分配
   
进程区详情:
   	PID: 进程的ID。
   
   ​	USER: 进程属主的名字。
   ​	PR: 进程的优先级。
   ​	NI: 进程的谦让度值。
   ​	VIRT: 进程占⽤的虚拟内存总量。
   ​	RES: 进程占⽤的物理内存总量。
   ​	SHR: 进程和其他进程共享的内存总量。
   ​	S: 进程的状态 (与 ps 基本相同)。
   ​	%CPU: 进程使⽤的CPU时间⽐例。
   ​	%MEM: 进程使⽤的内存占可⽤内存的⽐例。
   ​	TIME+: ⾃进程启动到⽬前为⽌的CPU时间总量。
   ​	COMMAND: 进程所对应的命令⾏名称，也就是启动的程序名。

进程太多时，可以通过 -p 参数指定需要查看的进程ID，让进程信息更精简：

​	top -p PID1,PID2,PID3,...

htop 命令
如果感觉 top 还不够直观，可以使⽤ htop
htop 不是系统默认的命令，需要额外安装
安装: sudo apt install htop
详情:

![](C:\Users\lwq\Desktop\Linux\linux操作3\img\1567168174535.png)

### 二、进程的管理

​		kill : 杀死进程, 或者给进程发送信号
​				-1 (HUP) 平滑重启
​				-9 (KILL) 强制杀死进程
​				-15 (TERM) 正常终⽌进程 (kill 的默认信号)
​		pkill [ProcessName] 按名字处理进程
​		killall [MatchedProcessName] 处理名字匹配的进程

### 三、其他状态

#### 1.内存状态 free

![](C:\Users\lwq\Desktop\Linux\linux操作3\img\1567168436777.png)

可以通过 -m 或 -g或-h 参数调整 free 命令显示数值的单位。

#### 2、硬盘

​		iostat : 查看硬盘写⼊和读取的状态
​		df -lh : 查看硬盘分区，及每个分区的剩余空间
​		du -hs ./ : 查看当前⽬录占⽤的硬盘⼤⼩

#### 3、网络状态

- ifconfig 查看⽹卡状态, 常⽤来检查⾃身 IP 地址

- netstat -natp 查看⽹络连接状态
  		-a : 显示所有选项
    		-t : 显示所有与TCP相关的选项
    		-u : 显示所有与UDP相关的选项
    		-x : 显示所有与Unix域相关的套接字选项
    		-n : 拒绝显示别名，能显示数字的全部转换为数字显示
    		-p : 显示建⽴相关连接的程序名。
    		-l : 显示所有状态为Listen的连接
    		-e : 显示扩展信息,如当前链接所对应的⽤户
    		-c : 间隔⼀段时间执⾏⼀次netstat命令。
    		-s : 显示统计信息。对每种类型进⾏汇总

- ping -i 0.5 -c 100 xx.xx.xx.xx
  		-i : 间隔
    		-c : 数量
    		-q : 安静模式, 只打印结果

- lsof   查看文件的打开状态
  		lsof -i :[PORT] 查看占⽤端⼝的程序
    		lsof -i tcp 查看所有 TCP 连接
    		lsof -u abc 查看⽤户 abc 打开的所有⽂件
    		lsof -p 123 查看 pid 为 123 的进程打开的所有⽂件

- 路由追踪: traceroute [HOST]
- DNS 查询
          dig [DOMAIN]
          host [DOMAIN]
          nslookup [DOMAIN]

### 5、时间与日期

- date : 查看⽇期与时间
- ![1567388359320](C:\Users\lwq\Desktop\Linux\linux操作3\1567388390954.png)
- cal : 查看⽇历
  - --one（-1） : 查看本⽉的⽇历
  - --three （-3）: 查看最近三个⽉的⽇历
  - --year （1）: 查看全年的⽇历
- time ： cpu的占用时间

#### 6、下载

- curl 执⾏ HTTP 访问，也可⽤来下载   需要借助重定向到ngx.tgz下载

- wget 下载  

- scp : 在服务器之间上传或下载 scp root@x.x.x.x:/root/abc ./abc

  登录服务器：ssh python1905@10.11.55.119

上传图片：scp ./图片/5e5fe78324055d60803a6560a0ebe463.jpg python1905@10.11.55.119:/home/python1905/linux/

下载：scp python1905@10.11.55.119:/home/python1905/linux/前四天的文档.zip ./图片

