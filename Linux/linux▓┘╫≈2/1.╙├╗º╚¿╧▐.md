### 一、Linux中的用户与组

Linux是一个多用户系统，为了方便管理多个用户，产生了用户组

- 每个⽤户都有唯⼀的⽤户名，并且 Linux 会分配⼀个唯⼀的 UID 与之对应。
- 同样每个⽤户组也有唯⼀的名称，Linux 会分配⼀个唯⼀的 GID 给每⼀个⽤户组。
- root ⽤户的 uid 和 gid 都是 0
- ⽤户名与 UID 的对应关系记录在 /etc/passwd 中。
- ⽤户组与 GID 的对应关系记录在 /etc/group 中。
- ⽤户的密码信息记录在 /etc/shadow

#### passwd格式

单行格式：root:0:0:root:/bin/bash

| 列        | 说明                       |
| --------- | -------------------------- |
| root      | 用户的名字                 |
| x         | 曾经用作记录密码，现已作废 |
| 0         | UID                        |
| 0         | GID                        |
| root      | 对用户root的说明           |
| /root     | 用户的家目录               |
| /bin/bash | 用户登录后使用的shell类型  |

#### shadow

单行格式：root:$6$RONPx5r2$THDsUhtM3if30Opth0s:18137:0:99999:7:::

不是md5加密，更加的安全sha256加密

说明

| 列         | 说明                                    |
| ---------- | --------------------------------------- |
| root       | 用户名                                  |
| root~18137 | 加密过的密码，不能解密                  |
| 18137      | 最后一次修改密码的日期(从1970.1.1开始)  |
| 0          | 密码几日内不可修改（0表示可以随时删除） |
| 99999      | 密码有效天数                            |
| 7          | 密码失效前几天提醒用户修改              |
|            | 密码失效的宽限天数                      |
|            | 账户失效日期                            |
|            | 保留字段                                |

#### group格式

单行格式:adm​：x:4:syslog,lwq,jerry

| 列               | 说明                           |
| ---------------- | ------------------------------ |
| adm              | 组名                           |
| x                | 组密码，已弃用                 |
| 4                | 组ID(GID)                      |
| syslog,lwq,jerry | 改组的成员，可以使用该组的方法 |

## 二、用户管理

### 1.添加用户

- 格式：sudo useradd -mU -s /bin/bash -G 组名1，组名2 用户名

- 参数：
  - -G GROUPS:新账户的附加组列表
  - -m：在/home目录创建用户的家目录
  - -U: 创建与用户同名的组
  - -p PASSWDORD:加密后得账户密码（已废弃）
  - -D:设置新用户为默认的形式

#### 2、删除用户

格式：sudo userdel -r  -f 用户名

参数：-r  删除主目录和邮件池

​			-f  强制删除（force）

#### 3、修改用户密码

格式：passwd 用户名

#### 4、切换用户

格式：su 用户名 ：仅仅切换用户身份，所在路径不会改变

​			su - 用户名：完全以这个用户进行登录，初始化当前用户的设置

### 三、用户组管理

#### 1、添加组

- 格式：groupadd [选项] 组名
- 选项：
  - -g	GID: 为新组创建GID
  - -p    PASSWORD:为新组创建密码（加密）
  - -r     创建一个系统账户

#### 2、删除组

格式：groupdel	组名

#### 4、修改用户属性

- 格式：usermod [选项] 用户名
- sudo usermod -aG sudo tom （把tom追加到组sudo的后面）
- 选项：
  - -d HOME_DIR:用户的新主目录
  - -g  group:强制使用group为新主组
  - -G groups:新的附加组列表groups
  - -a group:将用户追加至上边-G中提到的附加组中
  - -L :锁定用户账号
  - -m:将家目录内容移至新位置（仅与-d一起使用）
  - -s shell:该用户账号的新登录shell
  - -U:解锁用户账号

alias crtu="sudo useradd -mU -s /bin/bash -G adm,sudo"

 crtu jerry	创建新用户jerry

用alias把命令定义成变量

### 四、查看登录的用户

who 		查看谁正在登录
w 			 查看谁正在登录，并在显示每个登陆⽤户正在执⾏的任务
last		   查看历史登陆记录
lastb         查看失败的登陆记录
lastlog 	 查看全部⽤户最后⼀次登陆的时间

### 五、文件权限

#### 1、权限的定义

文件或目录有三种权限：

r			read，读权限

w			write，写入权限

x			execute，执行权限

同时也规定了不同用户身份对同一个文件有不同的权限，用户身份分三种：

1.owner 文件拥有用户

2.group 同组用户

3.other 其他用户

使用 ls -l 可以查看文件的权限信息：

-rw-r--r-- 	    1     lwq     lwq   31 	   8月  29 11:23 	aa
drwxr-xr-x 	4     lwq      lwq 4096 	8月  27 20:46 	b
drwxr-xr-x     4     lwq      lwq 4096     8月  27 21:16 	c	

d   文件夹

l   软链接

`-`普通文件

s   socket文件

c  /dev/里面的文件类型

最左边⼀列就是每个⽂件的权限信息，⼀共包含 9 个基本权限，分别是 owner / group / others 三种身份各有自己的 read / write / execute 权限。
以 drwxr-xr-x 为例，第⼀个字符可以忽略(表示文件类型)，后⾯的 9 个字符分为三组:

1. rwx : ⽂件拥有者对该⽂件具有 “读、写、可执⾏” 的权限
2. r-x : 同组⼈具有 “读、可执⾏” 的权限，没有写权限
3. r-- : 其他⼈只有 “读” 权限



#### 2、权限修改

1. 通过符号修改权限
	chmod	(u/g/o/a)  (+(加入)/-(除去)/=(指定)) （r/w/x）文件或目录   （a代表三种用户）

例如:
设置⾃⼰可读可写可执⾏,同组可读可执⾏，其他⼈可执⾏: chmod u=rwx,g=rx,o=x
hello.py
给⾃⼰和同组⼈增加读写权限: chmod ug+rw abc.png
给同组⼈和其他⼈删除写权限: chmod go-w abc.png
给所有⼈增加执⾏权限: chmod a+x test.py

2. 通过数字修改权限

   例1: chmod 753 hello.py
   身份: 7 / 5 / 3 这三个数字分别对应着 owner / group / others 三个身份
   权限值: 将每个数字转成三位⼆进制数字分别为 111 / 101 / 011 ，与权限对应关系如下:

   数字 	⼆进制 	权限
   7 			111 		rwx
   5 			101 		r-x
   3 			011 		-wx

   例2:
   问题: 将⽂件权限修改为：⾃⼰可读可写，同组可写可执⾏，其他⼈可写
   答案: chmod 632 test.py

#### 3、修改文件拥有着

​	⽤法: chown 	-R   ⽤户:组 		⽂件

```html
一键权限变成自己的  chown `id -u`:$(id -g) xxx
```

  ### 六、文本操作

​	echo xyz : 打印⽂本
​	echo xyz > a.txt : 将输出的⽂本重定向到⽂件a.txt中，a.txt原有内容会被覆盖

​	echo -e 'adsd\nasdf'带上-e转义字符才会有用	

​	echo xyz >> a.txt : 将输出的⽂本追加到⽂件a.txt中，a.txt原有内容不会被覆盖

**输入的重定向** EOF成对

![1567387890878](C:\Users\lwq\Desktop\Linux\linux操作2\1567387890878.png)

​	cat ⽂件名 : 查看⽂件
​	head -n N ⽂件名 : 查看⽂件的前 N ⾏
​	tail -n N ⽂件名 : 查看⽂件的后 N ⾏
​	less ⽂件 : 快速浏览⽂件
​		按 j 向下
​		按 k 向上
​		按 f 向下翻屏
​		按 b 向上翻屏
​		按 g 到全⽂开头
​		按 G 到全⽂结尾
​		按 q 退出
​	sort ⽂本或⽂件 : 将结果按升序排序
​	sort -r ⽂本或⽂件 将结果按降序排序
​	uniq 去重, 依赖排序, 常跟在 sort 后⾯使⽤
​	awk '{print $N}' 打印出相关列（引号）
​	wc 字符统计
​		-c : 统计字符
​		-w : 统计单词
​		-l : 统计⾏
​	例如: 统计代码⾏数 wc -l abc.py（不带参数默认统计所有按  行、单词、字符）

⽂本过滤 grep
	参数
		-i 忽略⼤⼩写
		-I 忽略⼆进制⽂件
		-r 递归查找⽬录
		-n 打印⾏号
		-c 只显示匹配到的个数
		-l 只显示匹配到的⽂件列表
		-o 只显示匹配到的单词
		-v 忽略制定的字段
		-E 通过正则表达式匹配
		`--include='*.py' 仅包含 py ⽂件`
		`--exclude='*.js' 不包含 js ⽂件`

​	管道符: |
​		管道符可以连接多个命令，将前⾯的输出作为后⾯的输⼊
练习: 统计出⾃⼰使⽤的最多的 10 个命令
​		答案: history | awk '{print $2}' | sort | uniq -c | sort -gr | head -n 10

uniq -c  （-c）统计命令出现几次

sort -gr 按出现次数排倒序

### 七、vim
VIM 是终端下最常⽤的编辑器，有 “编辑器之神” 之称，简洁⽽强⼤！
VIM 分为三种模式：命令模式，插⼊模式，底栏命令模式

1. 按 esc 键，进⼊命令模式
h, j, k, l 光标左、下、上、右移动
ctl + e 向下滚动
ctl + y 向上滚动
ctl + f 向下翻屏
ctl + b 向上翻屏
yy 复制整⾏
yw 复制整⾏
p 粘贴到下⼀⾏
P 粘贴到下⼀⾏
dd 删除整⾏
d3w 向前删除3个单词
7x 删除7个字符
u 撤销
ctl + r 重做
c3w 剪切3个单词
gg 跳⾄⽂件⾸⾏
shift + g 跳⾄⽂件结尾
shift + h 跳⾄屏幕⾸⾏
shift + m 跳⾄屏幕中间
shift + l 跳⾄屏幕结尾
ctl + v 列编辑
shift + v 选中整列
shift + > 向右缩紧
shift + < 向左缩紧
2. 按 i 键，进⼊插⼊模式
插⼊模式下正常输⼊即可
想做其他操作，必须先按 ESC 键回到命令模式
3. 在命令模式时按 : 键，进⼊底栏命令模式
23 跳⾄⽂件的第 23 ⾏
%s/abc/123/g 把⽂件中所有的 abc 替换成 123
set nu 打开⾏号
set nonu 关闭⾏号
w 保存
q 退出
wq 保存并退出
4. vim 配置⽂件 ~/.vimrc

5. 备注
https://coolshell.cn/articles/5426.html
http://www.oschina.net/question/615783_148433
我的 vimrc https://raw.githubusercontent.com/seamile/rc.d/master/vimrc

