## 1.什么是ajax

Asynchronous: 异步   在使用协程时，导入的包是asyncio

JavaScript :js技术   And：和      XML：xml数据格式

在页面没有刷新的情况下，通过客户端（浏览器）与服务器交互的技术

特点就是不刷新页面完成请求

python和php

1.php是nginx和apache服务器自带的环境，php不需要安装

2.php下载好后，内部自带微型服务器编码（tcp,自带模板）

3.python需要安装，python的tcp需要自己封装，需要封装模板

4.每一个框架中自带一个微型服务器

**比如说豆瓣网的电影内容加载，，瀑布流模式**

## 2.ajax的起源

98年IE5.5浏览器使用（outlook小组研发），起名XMLHTTP

05年Google真正把ajax应用到网页中（Google Map,Google Gmail）

## 3.原生js的ajax写法

IE8一下版本：var xhr = new ActiveXobject('Microsoft.XMLHTTP');

基于W3C内核的IE8以上和Google,firefox

var xhr = new XMLHttpRequest();

```html
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	
	<script type="text/javascript">
	window.onload=function(){
	        var obtn = document.getElementById('one');
	        //给按钮绑定事件，向服务器端请求数据
	        obtn.onclick=function(){
	                //具体的请求步骤
	                //(1)创建一个ajax对象，
	                var xhr = new XMLHttpRequest();
	                //(2)设置监听事件，处理回调函数
	                xhr.onreadystatechange = function(){
	                        //(5)完成请求后的处理
	                         if(xhr.readyState==4){
	                                var res = xhr.responseText;//返回的数据结果
	                                console.log(res);
	                         }
	                }
	                //(3)创建一个http的请求
	                xhr.open('get','demo1.php');
	                //(4)发送请求
	                xhr.send(null);
	        }
	}
	</script>
	</head>
	<style type="text/css">
	</style>
	</head>
	    <body>
	    <input type="button" value="获取数据服务器端的数据" id="one" />
	    </body>
</html>

```

## 二、Jquery中的ajax

### 1.jquery中ajax引用

底层实现

1.jQuery.ajax(options);

2.$.ajax;

2.高级实现

$.get(url,[data],[callback])

$.post(url,[data],[callback])

### 2.ajax的实现

$.ajax({参数})

参数：要求json对象

async:是否异步，默认true

cache:是否缓存，默认true,只适用于get获取数据

complete:当ajax状态码为4时，所触发的回调函数

contentType:请求头 信息，如果是post请求，默认是，application/x-www-form-urlencoded

**data:发送Ajax时传递的参数，要求是一个字符串或json对象。**

**dataType:期待的返回值类型，常用的text、XML、json,默认时text**

**success:当Ajax状态码为4并且响应状态码为200时，所触发的回调函数**

**type:http请求的类型，get和post #  get,post,put,patch,delete**

**url:请求的页面。**

### 使用$.ajax计算两个数的和get和post请求

使用data,传入json格式数据

使用post时，需要改php中的GET

```html
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="jquery-1.8.3.js"></script>
		<script type="text/javascript">
			$(function() {
				$("input[type=button]").click(function() {
					//获取输入的两个数的值
					var num1 = $('#num1').val();
					var num2 = $('#num2').val();
					//写ajax的请求了
					//get请求使用方式三，data是一个 json格式的数据。
					$.ajax({
						type: 'get',
						data: {
							num1: num1,
							num2: num2
						},
						url: 'demo2.php',
						success: function(msg) {
							$('#res').html(msg);
						}
					});
				});
			});
		</script>
	</head>
	<body>
		第一个数：<input type="text" name="num1" id="num1" /><br />
		第二个数：<input type="text" name="num2" id="num2" /><br />
		<input type="button" value="计算两个数的和" /><span id="res"></span>
	</body>
</html>
```

### 3.解决Ajax中缓存问题

在IE中使用get,系统会存在缓存问题

在原生js的Ajax中，是在url后面添加随机数或者添加事件戳或者添加If-Modified-Since解决

在jQuery的Ajax中，可以使用cache:false解决

### 4.xml和json

#### 1.ajax中xml处理大批数据

xml时一种DTD严格约束型的数据传输格式，在互联网的第三方支付和金融交易中经常使用的一种数据交互格式

目前在互联网中的使用量大约在5%

xml可以控制自定义标签中可以输入'值的类型'和'长度'或者其它的约束

返回复杂的xml数据

```html
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="jquery-1.8.3.js"></script>
		<script type="text/javascript">
			$(function() {
				$("input[type=button]").click(function() {
					$.ajax({
						type: 'get',
						dataType: 'xml',
						url: 'demo5.php',
						success: function(msg) {
							//返回的是复杂的xml数据。
							var str = '';
							$(msg).find('book').each(function(i, item) {
								str += $(item).find('name').text() + '---' + $(item).find('price').text() + '<br/>';
							});
							$('#res').html(str);
						}
					});
				});
			});
		</script>
	</head>
	<body>
		<input type="button" value="获取数据" />
		<hr />
		<div id="res"></div>
	</body>
</html>

```

demo5.xml

```html
<root>
        <book>
                <name>php文件该怎么写</name>
                <price>123.45</price>
        </book>
        <book>
                <name>怎么没反应呢</name>
                <price>63.45</price>
        </book>
        <book>
                <name>么么头</name>
                <price>163.45</price>
        </book>
         <book>
                <name>js从入门到放弃</name>
                <price>56.45</price>
        </book>
</root>

```

#### 2.ajax中json处理数据

```html
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="jquery-1.8.3.js"></script>
		<script type="text/javascript">
			$(function(){
				$('input[type=button]').click(function(){
					$.ajax({
						url:'demo.json',
						type:'get',
						dataType:'json',
						success:function(m){
							//显示在table中
							var str_ = "";
							$(m).each(function(i,item){
								str_ +="<tr>"
								for(var j in item){
									str_ +="<td>"+item[j]+"</td>"
								}
								str_ +="<tr>"
							});
							$('table').append(str_);
						},
					});
				});
			});
			
		</script>
	</head>
	<body>
		<table border='1 solid black' rules='all'>
			<tr>
				<th>姓名</th>
				<th>年龄</th>
				<th>性别</th>
			</tr>
		</table>
		<input type="button" value="点击" />
		
	</body>
</html>

```

demo.json

[
	{
		"name":"tom",
		"age":20,
		"sex":"male"
	},
	{
		"name":"jack",
		"age":18,
		"sex":"male"
	},
	{
		"name":"tony",
		"age":22,
		"sex":"male"
	}
]